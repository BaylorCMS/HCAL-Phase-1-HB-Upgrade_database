{% extends "qie_cards/base.html" %}
{% load app_filters %}

{% block title %}{{card.barcode}}{% endblock %}

{% block links %}
<a href="../catalog"><button>Catalog</button></a>
<a href="../summary"><button>Summary</button></a>
<a href="../testers"><button>Testers</button></a>
<a href="../setup"><button>Setup</button></a>
<a href="../stats"><button>Stats</button></a>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-4" align="center">
        <h1>Barcode: {{card.barcode | default:"No barcode uploaded"}}</h1>
        <h3>UID: {{card.get_uid_flipped | default:"No UID uploaded"}}</h3>
    </div>
</div>
<div class="row">
    <div class="col-md-6" align="left">
        <h3>Comments:</h3>
        <h5>{{card.comments | default:"No comment given"}}</h5>
    </div>
</div>

<hr/>

<div class="row">
    <div class="col-md-12">
        <h3>Locations</h3>
        {% for location in locations %}
        <br>
        <h4>{{location.geo_loc}}</h4>
        <table class="table table-bordered table-striped Portage_table" style="width: 60%; background-color: #F6F6F6;">
            <tbody>
                <tr>
                    <td><b>Date:</b></td>
                    <td colspan="3"> {{location.date_received | default:"No date recorded"}} </td>
                </tr> 
            </tbody>
        </table>
        {% endfor %}
    </div>
</div>
{% for test in attempts %}
<hr/>
<div class="row">
    <div class="col-md-12">
        <h3>{{test}}</h3>
        {% for attempt in attempts|get_item:test %}
        <br>
        <h4>Attempt: {{attempt.attempt_number}}</h4>
        <table class="table table-bordered table-striped Portage_table" style="width: 60%; background-color: #F6F6F6;">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Date</th>
                    <th>Tests Passed</th>
                     
                    {% if not attempt.revoked %}
                    <th>Tests Failed</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                <tr class="{{attempt.get_css_class}}">
                    <td> {{attempt.tester}} </td>
                    <td> {{attempt.date_tested}} </td>
                    {% if attempt.revoked %}
                    <td><b>Revoked</b>: (see comment) </td>
                    {% else %}
                    <td> {{attempt.num_passed}} </td>
                    <td> {{attempt.num_failed}} </td>
                    {% endif %}
                </tr>
                <tr class="{{attempt.get_css_class}}">
                    <td><b>Comments:</b></td>
                    <td colspan="3"> {{attempt.comments | default:"None"}} </td>
                </tr>
                <tr class="{{attempt.get_css_class}}">
                    <td><b>Image:</b></td> 
                    <td colspan="3">{% if attempt.has_image %}<a href="../media/{{attempt.image}}">{{attempt.image}}</a>
                                    {% else %} No image {% endif %}</td>
                </tr>
                <tr class="{{attempt.get_css_class}}">
                    <td><b>Log Files:</b></td>
                    <td colspan="3">{% if attempt.has_log %}<a href="../media/{{attempt.log_file}}">{{attempt.log_file}}</a>
                                    {% else %} No file {% endif %}</td>
                </tr>
            </tbody>
        </table>
        {% if attempt.has_image %}
        <a href="../media/{{attempt.image}}"><img src="../media/{{attempt.image}}" style="width:66%"></a>
        {% endif %}
        {% endfor %}
    </div>
</div>
<br/>
{% endfor %}
{% endblock %}
